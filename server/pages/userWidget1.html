<span id="span_id">ویجت داشبورد سطح user</span>

<Basis
  core="component.local.DemoComponent"
  run="atclient"
  triggers="event.click"
>
</Basis>

<script>
  if (typeof window.DemoComponent === "undefined") {
    class _DemoComponent {
      constructor(owner) {
        this.owner = owner;
        const scheduler = owner.dc.resolve("scheduler");
        const taskOptions = {
          container: document.getElementById("span_id"),
          task: processTask,
        };

        const k = scheduler.startTask(taskOptions);
        console.log(k);
      }

      async initializeAsync() {
        console.log("initializeAsync");
      }

      async runAsync() {
        console.log("runAsync");
        const date = new Date();
        const node = this.owner.toNode(
          `<div>${date.getHours()}:${date.getMinutes()}:${date.getSeconds()}:${date.getMilliseconds()} <div>`
        );
        this.owner.setContent(node);
      }
    }
    var DemoComponent = _DemoComponent;
  }

  const processTask = new Promise((resolve, reject) => {
    setTimeout((_) => {
      resolve();
      console.log("end");
    }, 3000);
  });
</script>
